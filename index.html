<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 北海道九天八夜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f6f2;
            color: #3f3d3d;
            margin: 0;
            padding: 0;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .card {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            background-color: #fff;
        }
        .pill-tab-button {
            border-radius: 9999px;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
        }
        .pill-tab-button.active {
            background-color: #e5dcd1;
            border-color: #e5dcd1;
            color: #3f3d3d;
        }
        .pill-tab-button:hover:not(.active) {
            background-color: #f0f0ed;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        th, td {
            padding: 12px 15px;
            border: 1px solid #e5e5e0;
            text-align: left;
        }
        th {
            background-color: #f0f0ed;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        tr:nth-child(even) {
            background-color: #fafafa;
        }
        tr:hover {
            background-color: #f0f0ed;
        }
        .collapsible-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s ease;
        }
        .collapsible-header:hover {
            background-color: #f0f0ed;
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .collapsible-content.open {
            max-height: 1000px; /* Adjust as needed for content height */
        }
        .chevron {
            transition: transform 0.3s ease;
        }
        .chevron.rotated {
            transform: rotate(180deg);
        }
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 500px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        .modal-details li {
            padding: 4px 0;
        }
    </style>
</head>
<body class="p-0">
    <div class="max-w-9xl mx-auto p-0 md:p-0">
        <header class="text-center">
        </header>

        <div class="card rounded-xl p-4 md:p-8">
            <div class="flex flex-wrap justify-center md:justify-start gap-2 p-2 bg-gray-100 rounded-full mb-6">
                <button id="tab-overview" class="pill-tab-button active flex-1 md:flex-none text-center text-gray-600 font-semibold focus:outline-none">
                    旅程總覽
                </button>
                <button id="tab-itinerary" class="pill-tab-button flex-1 md:flex-none text-center text-gray-600 font-semibold focus:outline-none">
                    詳細行程
                </button>
                <button id="tab-lodging" class="pill-tab-button flex-1 md:flex-none text-center text-gray-600 font-semibold focus:outline-none">
                    住宿資訊
                </button>
                <button id="tab-restaurants" class="pill-tab-button flex-1 md:flex-none text-center text-gray-600 font-semibold focus:outline-none">
                    餐廳推薦
                </button>
                <button id="tab-map" class="pill-tab-button flex-1 md:flex-none text-center text-gray-600 font-semibold focus:outline-none">
                    地圖
                </button>
                <button id="tab-expenses" class="pill-tab-button flex-1 md:flex-none text-center text-gray-600 font-semibold focus:outline-none">
                    費用分析
                </button>
            </div>

            <div id="content-overview" class="tab-content active bg-white rounded-b-lg p-4 md:p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">核心資訊</h2>
                    <p class="text-gray-500 mb-6">
                        此處彙整了本次北海道九天八夜自由行的所有關鍵資訊，從預算分配到每日行程安排。您可以透過頂部導覽列探索不同部分，旨在讓旅途規劃與參考變得更加輕鬆便利。
                    </p>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                        <div class="bg-gray-100 p-4 rounded-xl">
                            <h3 class="font-bold text-gray-700">9天8夜</h3>
                            <p class="text-sm text-gray-500">行程時長</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-xl">
                            <h3 class="font-bold text-gray-700">1/18-1/26</h3>
                            <p class="text-sm text-gray-500">2026 冬季</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-xl">
                            <h3 class="font-bold text-gray-700">札幌進/函館出</h3>
                            <p class="text-sm text-gray-500">主要路線</p>
                        </div>
                        <div class="bg-gray-100 p-4 rounded-xl">
                            <h3 class="font-bold text-gray-800">$54,641</h3>
                            <p class="text-sm text-gray-500">預估費用/人</p>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">航班資訊</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>日期</th>
                                    <th>行程時間</th>
                                    <th>航班</th>
                                    <th>價錢</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1/18</td>
                                    <td>12:30-17:20</td>
                                    <td>TR892</td>
                                    <td class="text-red-500">$9,630</td>
                                </tr>
                                <tr>
                                    <td>1/26</td>
                                    <td>18:00-21:35</td>
                                    <td>JX861</td>
                                    <td class="text-red-500">$13,488</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">行程總覽</h2>
                    <div class="p-4 rounded-xl bg-gray-50">
                        <ul class="list-disc ml-6 space-y-2 text-gray-600">
                            <li><span class="font-semibold">第一天 (1/18)</span>：台南 > 桃園 > 札幌，新千歲機場吃晚餐後前往飯店。</li>
                            <li><span class="font-semibold">第二天 (1/19)</span>：札幌市區一日遊，參觀北海道神宮與圓山動物園。</li>
                            <li><span class="font-semibold">第三天 (1/20)</span>：札幌近郊，遊覽白色戀人與札幌啤酒博物館。</li>
                            <li><span class="font-semibold">第四天 (1/21)</span>：札幌市區，前往火腿巨蛋並欣賞藻岩山夜景。</li>
                            <li><span class="font-semibold">第五天 (1/22)</span>：小樽一日遊。</li>
                            <li><span class="font-semibold">第六天 (1/23)</span>：札幌 > 洞爺湖，遊覽登別地獄谷晚上住洞爺湖。</li>
                            <li><span class="font-semibold">第七天 (1/24)</span>：洞爺湖 > 函館，前往五稜郭。</li>
                            <li><span class="font-semibold">第八天 (1/25)</span>：函館市區觀光，逛朝市、金森倉庫群並欣賞函館山夜景。</li>
                            <li><span class="font-semibold">第九天 (1/26)</span>：函館 > 回國。</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="content-itinerary" class="tab-content p-4 md:p-6 bg-white rounded-b-lg">
                <h2 class="text-2xl font-semibold mb-4 text-gray-700">行程</h2>
                <div class="space-y-6">
                    <!-- Day 1 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/18 (日) - 桃園 > 札幌</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">08:00:</span> 起床</li>
                                <li><span class="font-semibold">8:30-11:00:</span> 北海道神宮 > 圓山公園 > 圓山動物園</li>
                                <li><span class="font-semibold">11:30-13:00:</span> 午餐 (根室花丸11點前要到店拿號碼牌)</li>
                                <li><span class="font-semibold">13:00-14:30:</span> 北海道大學 > 看恐龍化石</li>
                                <li><span class="font-semibold">14:30-16:30:</span> 大通公園 > 電視塔</li>
                                <li><span class="font-semibold">18:00:</span> 狸小路吃海鮮丼</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 2 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/19 (一) - 札幌市內</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">07:30:</span> 起床</li>
                                <li><span class="font-semibold">8:30-11:00:</span> 北海道神宮 > 圓山公園 > 圓山動物園</li>
                                <li><span class="font-semibold">11:30-13:00:</span> 午餐 (根室花丸11點前要到店拿號碼牌)</li>
                                <li><span class="font-semibold">13:00-14:30:</span> 北海道大學 > 看恐龍化石</li>
                                <li><span class="font-semibold">14:30-16:30:</span> 大通公園 > 電視塔</li>
                                <li><span class="font-semibold">18:00:</span> 狸小路吃海鮮丼</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 3 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/20 (二) - 札幌市周邊</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">08:00:</span> 起床</li>
                                <li><span class="font-semibold">09:15-10:00:</span> 札幌車站 > 白色戀人工廠</li>
                                <li><span class="font-semibold">10:00-12:00:</span> 白色戀人工廠</li>
                                <li><span class="font-semibold">12:00-12:45:</span> 白色戀人工廠 > 札幌啤酒博物館</li>
                                <li><span class="font-semibold">13:00-14:00:</span> 博物館內吃午餐</li>
                                <li><span class="font-semibold">14:30-17:30:</span> 逛札幌啤酒博物館</li>
                                <li><span class="font-semibold">17:30-18:10:</span> 前往札幌車站 (領JR PASS)</li>
                                <li><span class="font-semibold">18:30:</span> 奥芝商店湯咖哩</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 4 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/21 (三) - 札幌市周邊</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">08:00:</span> 起床</li>
                                <li><span class="font-semibold">09:00:</span> 前往火腿巨蛋</li>
                                <li><span class="font-semibold">10:30:</span> 火腿巨蛋導覽 (一個小時)</li>
                                <li><span class="font-semibold">12:00-13:30:</span> 午餐</li>
                                <li><span class="font-semibold">13:30-14:30:</span> 火腿巨蛋>札幌車站</li>
                                <li><span class="font-semibold">14:30-15:00:</span> 札幌車站 T38 展望台 (JR車站可以買伴手禮)</li>
                                <li><span class="font-semibold">15:00-18:00:</span> 前往藻岩山夜景 (車資約5100日幣)</li>
                                <li><span class="font-semibold">18:00:</span> 狸小路附近吃飯 (北海道燒肉 北牛 KITAUSHI)</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 5 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/22 (四) - 小樽</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">07:00:</span> 起床</li>
                                <li><span class="font-semibold">08:06-08:53:</span> 札幌 > 小樽</li>
                                <li><span class="font-semibold">09:07-10:11:</span> 小樽車站 > 天狗山展望台</li>
                                <li><span class="font-semibold">10:11-11:30:</span> 天狗山展望台</li>
                                <li><span class="font-semibold">11:36-12:26:</span> 天狗山展望台 > 小樽車站</li>
                                <li><span class="font-semibold">12:30-14:00:</span> 午餐覓食 (三角市場或若雞時代)</li>
                                <li><span class="font-semibold">14:00-17:00:</span> 逛小樽附近景點</li>
                                <li><span class="font-semibold">17:00-17:33:</span> 小樽 > 札幌</li>
                                <li><span class="font-semibold">18:00:</span> 晚餐覓食</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 6 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/23 (五) - 札幌 > 洞爺湖</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">06:00:</span> 起床</li>
                                <li><span class="font-semibold">07:00:</span> 前往札幌車站</li>
                                <li><span class="font-semibold">07:30-08:44:</span> 札幌車站 > 登別車站 (交通參考 需要在車站寄放行李)</li>
                                <li><span class="font-semibold">08:52-09:30:</span> 搭公車前往登別地獄谷</li>
                                <li><span class="font-semibold">09:30-11:00:</span> 逛登別地獄谷</li>
                                <li><span class="font-semibold">11:00-12:10:</span> 吃午餐</li>
                                <li><span class="font-semibold">12:15-12:50:</span> 回登別車站</li>
                                <li><span class="font-semibold">13:28-14:08:</span> 登別 > 洞爺車站 (火車"北斗號")</li>
                                <li><span class="font-semibold">14:28-15:00:</span> 洞爺車站>飯店CHECK IN (休息一下)</li>
                                <li><span class="font-semibold">15:00-18:30:</span> 筒倉展望台>溫泉街逛街</li>
                                <li><span class="font-semibold">18:30:</span> 吃飯</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 7 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/24 (六) - 洞爺湖 > 函館</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">07:30-08:45:</span> 起床吃早餐</li>
                                <li><span class="font-semibold">09:00-10:00:</span> 坐遊覽船</li>
                                <li><span class="font-semibold">11:00:</span> 回飯店拿行李去洞爺車站</li>
                                <li><span class="font-semibold">11:30-12:40:</span> 車站附近吃午餐</li>
                                <li><span class="font-semibold">12:51-14:41:</span> 洞爺 > 函館 (OMO5 放行李)</li>
                                <li><span class="font-semibold">15:30-17:30:</span> 五稜郭 (日落有點燈活動)</li>
                                <li><span class="font-semibold">18:00:</span> 五稜郭附近吃晚餐 (大黒屋 函館五稜郭店)</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 8 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/25 (日) - 函館</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">08:00:</span> 起床</li>
                                <li><span class="font-semibold">09:00:</span> 函館朝市</li>
                                <li><span class="font-semibold">10:00-11:30:</span> 金森紅磚倉庫群</li>
                                <li><span class="font-semibold">11:30-13:00:</span> 午餐 (小丑漢堡)</li>
                                <li><span class="font-semibold">13:30-15:00:</span> 八幡坂 > 函館教堂群 > 函館山纜車</li>
                                <li><span class="font-semibold">15:00-16:30:</span> 函館夜景</li>
                                <li><span class="font-semibold">17:00:</span> 鳥辰十字街店 (燒鳥)</li>
                            </ul>
                        </div>
                    </div>
                    <!-- Day 9 -->
                    <div class="border rounded-lg">
                        <div class="collapsible-header p-4 flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 class="text-lg font-bold text-gray-800">1/26 (一) - 函館 > 回國</h3>
                            <svg class="chevron w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </div>
                        <div class="collapsible-content p-4">
                            <ul class="list-disc ml-6 space-y-2">
                                <li><span class="font-semibold">08:30:</span> 起床吃早餐 (退房行李寄放飯店)</li>
                                <li><span class="font-semibold">09:30-11:00:</span> 函館市熱帶植物園 (或者去大沼國家公園)</li>
                                <li><span class="font-semibold">14:30:</span> 回飯店拿行李</li>
                                <li><span class="font-semibold">15:00:</span> 前往機場報到</li>
                                <li><span class="font-semibold">18:00-21:35:</span> 回國</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="content-lodging" class="tab-content p-4 md:p-6 bg-white rounded-b-lg">
                <h2 class="text-2xl font-semibold mb-4 text-gray-700">住宿</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>日期</th>
                                <th>飯店</th>
                                <th>地址</th>
                                <th>價錢</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1/18-1/23</td>
                                <td>京王Prelia酒店</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/oo2b2WGkUb5sE7nCA" target="_blank">4 Chome-11-1 Kita 8 Jonishi, Kita Ward, Sapporo, Hokkaido 060-0808日本</a></td>
                                <td class="text-red-500">$9,385</td>
                            </tr>
                            <tr>
                                <td>1/23-1/24</td>
                                <td>The Lake Suit湖之栖</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/WUU2oDrmGhgcuWYf6" target="_blank">7-1 Toyakoonsen, Sobetsu, Usu District, Hokkaido 049-5731日本</a></td>
                                <td class="text-red-500">$7,214</td>
                            </tr>
                            <tr>
                                <td>1/24-1/26</td>
                                <td>OMO5 函館</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/f3t7GUrzqG94SDAT7" target="_blank">24-1 Wakamatsucho, Hakodate, Hokkaido 040-0063日本</a></td>
                                <td class="text-red-500">$4,063</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="content-restaurants" class="tab-content p-4 md:p-6 bg-white rounded-b-lg">
                <h2 class="text-2xl font-semibold mb-4 text-gray-700">餐廳推薦</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>類別</th>
                                <th>店名</th>
                                <th>地址</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>海鮮丼</td>
                                <td>Sapporo Kaisen-don Senmon Ten Sushi Donburi</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/EiqNbnPg8ZXqx3w88" target="_blank">日本〒060-0063 Hokkaido, Sapporo, Chuo Ward, Minami 3 Jonishi, 5 Chome-24 からくさホテル 1F</a></td>
                            </tr>
                            <tr>
                                <td>迴轉壽司</td>
                                <td>根室花丸 JR Tower</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/DGiPEtcb8HefdQsX6" target="_blank">日本〒060-0005 Hokkaido, Sapporo, Chuo Ward, Kita 5 Jonishi, 4 Chome JRタワーステラプレイス ６階</a></td>
                            </tr>
                            <tr>
                                <td>燒肉</td>
                                <td>北海道燒肉 北牛</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/vsdVKKXHL7WtymqS6" target="_blank">4 Chome-5-7 Minami 6 Jonishi, Chuo Ward, Sapporo, Hokkaido 064-0806日本</a></td>
                            </tr>
                            <tr>
                                <td>湯咖哩</td>
                                <td>奥芝商店湯咖哩</td>
                                <td><a class="text-blue-600" href="https://www.google.com/maps/search/?api=1&query=Sapporo%2C%20Chuo%20Ward%2C%20Kita%204%20Jonishi%2C%201%20Chome%20%E3%83%9B%E3%82%AF%E3%83%AC%E3%83%B3%E3%83%93%E3%83%AB%20B1F%20%E3%83%91%E3%83%BC%E3%83%AB%E3%82%BF%E3%82%A6%E3%83%B3" target="_blank">Sapporo, Chuo Ward, Kita 4 Jonishi, 1 Chome ホクレンビル B1F パールタウン</a></td>
                            </tr>
                            <tr>
                                <td>成吉思汗</td>
                                <td>大黒屋 函館五稜郭店</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/8rURFiwmnPGH768s9" target="_blank">23-5 Honcho, Hakodate, Hokkaido 040-0011</a></td>
                            </tr>
                            <tr>
                                <td>燒鳥</td>
                                <td>鳥辰十字街店</td>
                                <td><a class="text-blue-600" href="https://maps.app.goo.gl/FPQjbdLZVURXJCKm8" target="_blank">7-7 Suehirocho, Hakodate, Hokkaido 040-0053日本</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="content-map" class="tab-content p-0 md:p-0 bg-white rounded-b-lg">
                <!-- 將地圖容器高度調整為螢幕高度的 50% -->
                <div class="relative w-full rounded-lg" style="height: 75vh;">
                    <iframe 
                        src="https://www.google.com/maps/d/embed?mid=1mltIDX4-B6rG-VHdnv-5NMG6K7OoPDY&ehbc=2E312F" 
                        class="absolute top-0 left-0 w-full h-full" 
                        frameborder="0" 
                        allowfullscreen="" 
                        aria-hidden="false" 
                        tabindex="0">
                    </iframe>
                </div>
            </div>

            <div id="content-expenses" class="tab-content p-4 md:p-6 bg-white rounded-b-lg text-center">
                <h2 class="text-2xl font-semibold mb-4 text-gray-700">費用分析</h2>
                <div class="mb-4">
                    <p class="text-xl font-bold text-gray-800">總費用：<span class="text-red-500" id="total-cost-display"></span></p>
                </div>
                <div id="chart-container" class="w-full h-80"></div>
                <div class="mt-8 flex flex-wrap justify-center gap-4 text-sm text-left" id="legend-container"></div>
            </div>

            <!-- Modal for detailed expenses -->
            <div id="details-modal" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h3 id="modal-title" class="text-xl font-bold mb-4"></h3>
                    <ul id="modal-details-list" class="modal-details list-disc ml-4 space-y-1"></ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.pill-tab-button');
            const contents = document.querySelectorAll('.tab-content');
            const modal = document.getElementById('details-modal');
            const closeButton = document.querySelector('.close-button');
            const modalTitle = document.getElementById('modal-title');
            const modalDetailsList = document.getElementById('modal-details-list');

            // --- 費用分析數據與函式 ---
            const expensesData = [
                { category: '機票', value: 23118 },
                { category: '住宿', value: 9385 + 7214 + 4063 },
                { category: '交通 (日本)', value: 4541 },
                { category: '交通 (台灣)', value: 1190 + 2300 },
                { category: '通訊/保險', value: 1130 + 1700 }
            ];

            expensesData.sort((a, b) => b.value - a.value);

            const detailedExpensesData = {
                '機票': [
                    { name: '札幌進（TR892）', cost: 9630 },
                    { name: '函館出（JX861）', cost: 13488 }
                ],
                '住宿': [
                    { name: '京王Prelia酒店', cost: 9385 },
                    { name: 'The Lake Suit湖之栖', cost: 7214 },
                    { name: 'OMO5 函館', cost: 4063 }
                ],
                '交通 (日本)': [
                    { name: '北海道 JR PASS 五日券', cost: 4541 },
                ],
                '交通 (台灣)': [
                    { name: '高鐵（台南 > 桃園）', cost: 1190 },
                    { name: '桃園包車回台南', cost: 2300 }
                ],
                '通訊/保險': [
                    { name: '網卡', cost: 1130 },
                    { name: '旅平險', cost: 1700 }
                ]
            };

            function createPieChart() {
                const totalCost = expensesData.reduce((sum, item) => sum + item.value, 0);
                document.getElementById('total-cost-display').textContent = `$${totalCost.toLocaleString()}`;

                const chartContainer = document.getElementById('chart-container');
                const width = chartContainer.clientWidth;
                const height = Math.min(width, 320);
                const radius = Math.min(width, height) / 2.5;

                d3.select(chartContainer).select('svg').remove();
                d3.select('#legend-container').html('');

                const svg = d3.select(chartContainer)
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .append("g")
                    .attr("transform", `translate(${width / 2}, ${height / 2})`);

                const color = d3.scaleOrdinal(d3.schemeCategory10);

                const pie = d3.pie().value(d => d.value).sort(null);
                const arc = d3.arc().innerRadius(0).outerRadius(radius);
                const pieData = pie(expensesData);

                svg.selectAll('path')
                    .data(pieData)
                    .enter()
                    .append('path')
                    .attr('d', arc)
                    .attr('fill', (d, i) => color(i))
                    .attr('stroke', 'white')
                    .style('stroke-width', '2px')
                    .style('opacity', 0.8)
                    .on('click', function(event, d) {
                        showDetailsModal(d.data);
                    });

                const legend = d3.select('#legend-container')
                    .selectAll('.legend-item')
                    .data(expensesData)
                    .enter()
                    .append('div')
                    .attr('class', 'legend-item flex items-center mb-2');

                legend.append('div')
                    .attr('class', 'w-3 h-3 rounded-full mr-2')
                    .style('background-color', (d, i) => color(i));

                legend.append('span')
                    .text(d => `${d.category} ($${d.value.toLocaleString()})`);
            }

            function showDetailsModal(data) {
                const details = detailedExpensesData[data.category];
                if (details) {
                    modalTitle.textContent = data.category;
                    modalDetailsList.innerHTML = '';
                    details.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = `${item.name}: $${item.cost.toLocaleString()}`;
                        modalDetailsList.appendChild(li);
                    });
                    modal.style.display = 'block';
                }
            }

            closeButton.onclick = function() {
                modal.style.display = 'none';
            }

            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            }

            // Listen for window resize to redraw chart
            window.addEventListener('resize', () => {
                if (document.getElementById('content-expenses').classList.contains('active')) {
                    createPieChart();
                }
            });
            
            // --- 頁籤切換與功能初始化 ---
            function setActiveTab(tabId) {
                const targetId = tabId.replace('tab-', 'content-');
                
                tabs.forEach(item => item.classList.remove('active'));
                contents.forEach(item => item.classList.remove('active'));

                document.getElementById(tabId).classList.add('active');
                document.getElementById(targetId).classList.add('active');

                if (tabId === 'tab-expenses') {
                    createPieChart();
                }
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    setActiveTab(tab.id);
                });
            });

            // Handle collapsible itinerary sections
            const collapsibleHeaders = document.querySelectorAll('.collapsible-header');
            collapsibleHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const chevron = header.querySelector('.chevron');
                    
                    if (content.classList.contains('open')) {
                        content.classList.remove('open');
                        chevron.classList.remove('rotated');
                    } else {
                        document.querySelectorAll('.collapsible-content.open').forEach(c => c.classList.remove('open'));
                        document.querySelectorAll('.chevron.rotated').forEach(c => c.classList.remove('rotated'));

                        content.classList.add('open');
                        chevron.classList.add('rotated');
                    }
                });
            });

            // Initial active state
            setActiveTab('tab-overview');
        });
    </script>
</body>
</html>
